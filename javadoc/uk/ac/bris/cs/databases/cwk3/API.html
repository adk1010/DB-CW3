<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_91) on Thu May 05 18:09:32 BST 2016 -->
<title>API</title>
<meta name="date" content="2016-05-05">
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="API";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10,"i8":10,"i9":10,"i10":10,"i11":10,"i12":10,"i13":10,"i14":10,"i15":10,"i16":10,"i17":10,"i18":10,"i19":10,"i20":9};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../uk/ac/bris/cs/databases/cwk3/package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Class</li>
<li>Next&nbsp;Class</li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?uk/ac/bris/cs/databases/cwk3/API.html" target="_top">Frames</a></li>
<li><a href="API.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">uk.ac.bris.cs.databases.cwk3</div>
<h2 title="Class API" class="title">Class API</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>uk.ac.bris.cs.databases.cwk3.API</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="typeNameLabel">API</span>
extends java.lang.Object</pre>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../../../uk/ac/bris/cs/databases/cwk3/API.html#API-java.sql.Connection-">API</a></span>(java.sql.Connection&nbsp;c)</code>
<div class="block">API constructor</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>Result</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../uk/ac/bris/cs/databases/cwk3/API.html#addNewPerson-java.lang.String-java.lang.String-java.lang.String-">addNewPerson</a></span>(java.lang.String&nbsp;name,
            java.lang.String&nbsp;username,
            java.lang.String&nbsp;studentId)</code>
<div class="block">Create a new person.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>&lt;any&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../uk/ac/bris/cs/databases/cwk3/API.html#countPostsInTopic-long-">countPostsInTopic</a></span>(long&nbsp;topicId)</code>
<div class="block">Count the number of posts in a topic (without fetching them all).</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>Result</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../uk/ac/bris/cs/databases/cwk3/API.html#createForum-java.lang.String-">createForum</a></span>(java.lang.String&nbsp;title)</code>
<div class="block">Create a new forum.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>Result</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../uk/ac/bris/cs/databases/cwk3/API.html#createPost-long-java.lang.String-java.lang.String-">createPost</a></span>(long&nbsp;topicId,
          java.lang.String&nbsp;username,
          java.lang.String&nbsp;text)</code>
<div class="block">DELETEPOST NEEDS ROLLBACK</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>Result</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../uk/ac/bris/cs/databases/cwk3/API.html#createTopic-long-java.lang.String-java.lang.String-java.lang.String-">createTopic</a></span>(long&nbsp;forumId,
           java.lang.String&nbsp;username,
           java.lang.String&nbsp;title,
           java.lang.String&nbsp;text)</code>
<div class="block">DELETETOPIC NEEDS TO ROLLBACK</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>Result</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../uk/ac/bris/cs/databases/cwk3/API.html#favouriteTopic-java.lang.String-long-boolean-">favouriteTopic</a></span>(java.lang.String&nbsp;username,
              long&nbsp;topicId,
              boolean&nbsp;fav)</code>
<div class="block">Set or unset a topic as favourite.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>&lt;any&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../uk/ac/bris/cs/databases/cwk3/API.html#getAdvancedForum-long-">getAdvancedForum</a></span>(long&nbsp;id)</code>
<div class="block">Get the detailed view of a single forum, advanced version.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>&lt;any&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../uk/ac/bris/cs/databases/cwk3/API.html#getAdvancedForums--">getAdvancedForums</a></span>()</code>
<div class="block">Get the "main page" containing a list of forums ordered alphabetically
 by title.</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>&lt;any&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../uk/ac/bris/cs/databases/cwk3/API.html#getAdvancedPersonView-java.lang.String-">getAdvancedPersonView</a></span>(java.lang.String&nbsp;username)</code>
<div class="block">Get an AdvancedPersonView for the person with the given username.</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>&lt;any&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../uk/ac/bris/cs/databases/cwk3/API.html#getForum-long-">getForum</a></span>(long&nbsp;id)</code>
<div class="block">Get the detailed view of a single forum.</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>&lt;any&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../uk/ac/bris/cs/databases/cwk3/API.html#getForums--">getForums</a></span>()</code>
<div class="block">Get the "main page" containing a list of forums ordered alphabetically
 by title.</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>&lt;any&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../uk/ac/bris/cs/databases/cwk3/API.html#getLatestPost-long-">getLatestPost</a></span>(long&nbsp;topicId)</code>
<div class="block">THIS NEEDS WORK - NEVER RETURNS FAILURE DOESN'T CHECK FOR TOPIC EXISTS</div>
</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code>&lt;any&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../uk/ac/bris/cs/databases/cwk3/API.html#getLikers-long-">getLikers</a></span>(long&nbsp;topicId)</code>
<div class="block">Get all people who have liked a particular topic, ordered by name
 alphabetically.</div>
</td>
</tr>
<tr id="i13" class="rowColor">
<td class="colFirst"><code>&lt;any&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../uk/ac/bris/cs/databases/cwk3/API.html#getPersonView-java.lang.String-">getPersonView</a></span>(java.lang.String&nbsp;username)</code>
<div class="block">Get a PersonView for the person with the given username.</div>
</td>
</tr>
<tr id="i14" class="altColor">
<td class="colFirst"><code>&lt;any&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../uk/ac/bris/cs/databases/cwk3/API.html#getSimpleForums--">getSimpleForums</a></span>()</code>
<div class="block">Get the "main page" containing a list of forums ordered alphabetically
 by title.</div>
</td>
</tr>
<tr id="i15" class="rowColor">
<td class="colFirst"><code>&lt;any&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../uk/ac/bris/cs/databases/cwk3/API.html#getSimpleTopic-long-">getSimpleTopic</a></span>(long&nbsp;topicId)</code>
<div class="block">Get a simplified view of a topic.</div>
</td>
</tr>
<tr id="i16" class="altColor">
<td class="colFirst"><code>&lt;any&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../uk/ac/bris/cs/databases/cwk3/API.html#getTopic-long-int-">getTopic</a></span>(long&nbsp;topicId,
        int&nbsp;page)</code>
<div class="block">Get the detailed view of a topic.</div>
</td>
</tr>
<tr id="i17" class="rowColor">
<td class="colFirst"><code>&lt;any&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../uk/ac/bris/cs/databases/cwk3/API.html#getUsers--">getUsers</a></span>()</code>
<div class="block">Get a list of all users in the system as a map username -> name.</div>
</td>
</tr>
<tr id="i18" class="altColor">
<td class="colFirst"><code>Result</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../uk/ac/bris/cs/databases/cwk3/API.html#likePost-java.lang.String-long-int-boolean-">likePost</a></span>(java.lang.String&nbsp;username,
        long&nbsp;topicId,
        int&nbsp;post,
        boolean&nbsp;like)</code>
<div class="block">Like or unlike a post.</div>
</td>
</tr>
<tr id="i19" class="rowColor">
<td class="colFirst"><code>Result</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../uk/ac/bris/cs/databases/cwk3/API.html#likeTopic-java.lang.String-long-boolean-">likeTopic</a></span>(java.lang.String&nbsp;username,
         long&nbsp;topicId,
         boolean&nbsp;like)</code>
<div class="block">Like or unlike a topic.</div>
</td>
</tr>
<tr id="i20" class="altColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../uk/ac/bris/cs/databases/cwk3/API.html#main-java.lang.String:A-">main</a></span>(java.lang.String[]&nbsp;args)</code>
<div class="block">For Running Tests Only</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="API-java.sql.Connection-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>API</h4>
<pre>public&nbsp;API(java.sql.Connection&nbsp;c)</pre>
<div class="block">API constructor</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>c</code> - The connection to the database (ensure Foreign Key Constraints are enabled)</dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="main-java.lang.String:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>main</h4>
<pre>public static&nbsp;void&nbsp;main(java.lang.String[]&nbsp;args)</pre>
<div class="block"><h1>For Running Tests Only</h1></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>args</code> - Not used</dd>
</dl>
</li>
</ul>
<a name="getUsers--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getUsers</h4>
<pre>public&nbsp;&lt;any&gt;&nbsp;getUsers()</pre>
<div class="block"><p>Get a list of all users in the system as a map username -> name.</p>
 <p><b>Visual Test:</b> http://localhost:8000/people</p>
 <p><b>Main Contributor:</b> Joseph</p>
 <p><b>SQL:</b> SELECT username, name FROM Person;</p>
 <p>
 <b>How it works:</b>
 
 
 </p></div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>A map with one entry per user of the form username -> name
 (note that usernames are unique).</dd>
</dl>
</li>
</ul>
<a name="getPersonView-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getPersonView</h4>
<pre>public&nbsp;&lt;any&gt;&nbsp;getPersonView(java.lang.String&nbsp;username)</pre>
<div class="block"><p>Get a PersonView for the person with the given username.</p>
 <p><b>Visual Test:</b> http://localhost:8000/person/tb15269</p>
 <p><b>Main Contributor:</b> Tom</p>
 <p><b>SQL:</b> SELECT name, username, stuId FROM Person " + "WHERE username = ?;</p>
 <p>
 <b>How it works:</b>
 
 
 </p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>username</code> - the username to search for, cannot be empty.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>If a person with the given username exists, a fully populated
 PersonView. Otherwise, failure (or fatal on a database error).</dd>
</dl>
</li>
</ul>
<a name="getSimpleForums--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getSimpleForums</h4>
<pre>public&nbsp;&lt;any&gt;&nbsp;getSimpleForums()</pre>
<div class="block"><p>Get the "main page" containing a list of forums ordered alphabetically
 by title. Simple version that does not return any topic information.</p>
 <p><b>Visual Test:</b> http://localhost:8000/forums0</p>
 <p><b>Main Contributor:</b> Alex</p>
 <p><b>SQL:</b> SELECT id, title FROM Forum;</p>
 <p>
 <b>How it works:</b>
 
 
 </p></div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the list of all forums; an empty list if there are no forums.</dd>
</dl>
</li>
</ul>
<a name="countPostsInTopic-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>countPostsInTopic</h4>
<pre>public&nbsp;&lt;any&gt;&nbsp;countPostsInTopic(long&nbsp;topicId)</pre>
<div class="block"><p>Count the number of posts in a topic (without fetching them all).</p>
 <p><b>Visual Test:</b> </p>
 <p><b>Main Contributor:</b> Tom</p>
 <p><b>SQL:</b> SELECT COUNT(*) AS numposts FROM POST WHERE topicid = ?;</p>
 <p>
 <b>How it works:</b>
 
 
 </p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>topicId</code> - the topic to look at.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The number of posts in this topic if it exists, otherwise a
 failure.</dd>
</dl>
</li>
</ul>
<a name="getLikers-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getLikers</h4>
<pre>public&nbsp;&lt;any&gt;&nbsp;getLikers(long&nbsp;topicId)</pre>
<div class="block"><p>Get all people who have liked a particular topic, ordered by name
 alphabetically.</p>
 <p><b>Visual Test:</b> </p>
 <p><b>Main Contributor:</b> Joseph</p>
 <p><b>SQL:</b> SELECT Topic.id, Person.name, Person.username, Person.stuId
 FROM Topic
 LEFT OUTER JOIN Topic_Likers ON topic.id = Topic_Likers.topicid
 LEFT OUTER JOIN Person ON Topic_Likers.personid = Person.id
 WHERE Topic.id = ? 
 ORDER BY Person.name ASC;</p>
 <p>
 <b>How it works:</b>
 
 
 </p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>topicId</code> - The topic id. Must exist.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Success (even if the list is empty) if the topic exists,
 failure if it does not, fatal in case of database errors.</dd>
</dl>
</li>
</ul>
<a name="getSimpleTopic-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getSimpleTopic</h4>
<pre>public&nbsp;&lt;any&gt;&nbsp;getSimpleTopic(long&nbsp;topicId)</pre>
<div class="block"><p>Get a simplified view of a topic.</p>
 <p><b>Visual Test:</b> http://localhost:8000/topic0/1</p>
 <p><b>Main Contributor:</b> Alex</p>
 <p><b>SQL:</b> SELECT t.id as topicid, t.title, p.id as postid, per.username, p.text, p.postedAt FROM Topic AS t JOIN Post AS p ON t.id = p.topicid JOIN Person AS per ON p.authorid = per.id WHERE t.id = 1;</p>
 <p>
 <b>How it works:</b>
 
 
 </p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>topicId</code> - the topic to get.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The topic view if one exists with the given id,
 otherwise failure or fatal on database errors.</dd>
</dl>
</li>
</ul>
<a name="getLatestPost-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getLatestPost</h4>
<pre>public&nbsp;&lt;any&gt;&nbsp;getLatestPost(long&nbsp;topicId)</pre>
<div class="block"><h1>THIS NEEDS WORK - NEVER RETURNS FAILURE DOESN'T CHECK FOR TOPIC EXISTS</h1>
 <p>Get the latest post in a topic.</p>
 <p><b>Visual Test:</b> </p>
 <p><b>Main Contributor:</b> Tom</p>
 <p><b>SQL:</b> SELECT forum.id as forumid, post.topicid as topicid, 
post.id as postNumber, person.name as authorname, 
person.username as username, post.text as text, 
post.postedAt as postedAt, likes.numLikes as numberOfLikes 
FROM Post 
JOIN Person ON Post.authorid = Person.id 
JOIN Topic ON Post.topicid = Topic.id 
JOIN Forum ON Topic.forumid = Forum.id 
JOIN (SELECT postid, count(*) as numLikes FROM Post_Likers GROUP BY postid) as Likes ON Likes.postid = Post.id 
WHERE topicid = ? 
ORDER BY postNumber DESC LIMIT 1;</p>
 <p>
 <b>How it works:</b>
 
 
 </p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>topicId</code> - The topic. Must exist.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Success and a view of the latest post if one exists,
 failure if the topic does not exist, fatal on database errors.</dd>
</dl>
</li>
</ul>
<a name="getForums--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getForums</h4>
<pre>public&nbsp;&lt;any&gt;&nbsp;getForums()</pre>
<div class="block"><p>Get the "main page" containing a list of forums ordered alphabetically
 by title.</p>
 <p><b>Visual Test:</b> http://localhost:8000/forums</p>
 <p><b>Main Contributor:</b> Alex</p>
 <p><b>SQL:</b> SELECT lastTopic.id AS topicid, lastTopic.title AS topicTitle, f.title AS title, f.id AS id
 FROM Forum AS f
 JOIN (
 SELECT t.id AS id, t.forumid AS forumid, t.title AS title, p.postedAt AS postedAt
 FROM Topic t
 JOIN Post AS p ON t.id = p.topicid
 GROUP BY p.postedAt
 ) AS lastTopic ON f.id = lastTopic.forumid
 GROUP BY f.title;</p>
 <p>
 <b>How it works:</b>
 
 
 </p></div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the list of all forums, empty list if there are none.</dd>
</dl>
</li>
</ul>
<a name="createForum-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createForum</h4>
<pre>public&nbsp;Result&nbsp;createForum(java.lang.String&nbsp;title)</pre>
<div class="block"><p>Create a new forum.</p>
 <p><b>Visual Test:</b> http://localhost:8000/newforum</p>
 <p><b>Main Contributor:</b> Tom</p>
 <p><b>SQL:</b> INSERT INTO Forum (title) VALUES (?);</p>
 <p>
 <b>How it works:</b>
 
 
 </p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>title</code> - the title of the forum. Must not be null or empty and
 no forum with this name must exist yet.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>success if the forum was created, failure if the title was
 null, empty or such a forum already existed; fatal on other errors.</dd>
</dl>
</li>
</ul>
<a name="createPost-long-java.lang.String-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createPost</h4>
<pre>public&nbsp;Result&nbsp;createPost(long&nbsp;topicId,
                         java.lang.String&nbsp;username,
                         java.lang.String&nbsp;text)</pre>
<div class="block"><h1>DELETEPOST NEEDS ROLLBACK</h1>
 <p>Create a post in an existing topic.</p>
 <p><b>Visual Test:</b> http://localhost:8000/newpost/1</p>
 <p><b>Main Contributor:</b> Alex</p>
 <p><b>SQL:</b> INSERT INTO Post (authorid, topicid, text) VALUES ((SELECT id FROM Person WHERE username = ?), ?, ?);</p>
 <p>
 <b>How it works:</b>
 
 
 </p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>topicId</code> - the id of the topic to post in. Must refer to
 an existing topic.</dd>
<dd><code>username</code> - the name under which to post; user must exist.</dd>
<dd><code>text</code> - the content of the post, cannot be empty.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>success if the post was made, failure if any of the preconditions
 were not met and fatal if something else went wrong.</dd>
</dl>
</li>
</ul>
<a name="addNewPerson-java.lang.String-java.lang.String-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addNewPerson</h4>
<pre>public&nbsp;Result&nbsp;addNewPerson(java.lang.String&nbsp;name,
                           java.lang.String&nbsp;username,
                           java.lang.String&nbsp;studentId)</pre>
<div class="block"><p>Create a new person.</p>
 <p><b>Visual Test:</b> </p>
 <p><b>Main Contributor:</b> Tom</p>
 <p><b>SQL:</b> INSERT INTO Person (name, username, stuId) VALUES (?,?,?);</p>
 <p>
 <b>How it works:</b>
 
 
 </p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>name</code> - the person's name, cannot be empty.</dd>
<dd><code>username</code> - the person's username, cannot be empty.</dd>
<dd><code>studentId</code> - the person's student id. May be either NULL if the
 person is not a student or a non-empty string if they are; can not be
 an empty string.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Success if no person with this username existed yet and a new
 one was created, failure if a person with this username already exists,
 fatal if something else went wrong.</dd>
</dl>
</li>
</ul>
<a name="getForum-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getForum</h4>
<pre>public&nbsp;&lt;any&gt;&nbsp;getForum(long&nbsp;id)</pre>
<div class="block"><p>Get the detailed view of a single forum.</p>
 <p><b>Visual Test:</b> </p>
 <p><b>Main Contributor:</b> Tom</p>
 <p><b>SQL:</b> SELECT id as topicid, title as topictitle FROM Topic WHERE forumid = ?;</p>
 <p>
 <b>How it works:</b>
 
 
 </p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>id</code> - the id of the forum to get.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>A view of this forum if it exists, otherwise failure.</dd>
</dl>
</li>
</ul>
<a name="getTopic-long-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getTopic</h4>
<pre>public&nbsp;&lt;any&gt;&nbsp;getTopic(long&nbsp;topicId,
                      int&nbsp;page)</pre>
<div class="block"><p>Get the detailed view of a topic.</p>
 <p><b>Visual Test:</b> </p>
 <p><b>Main Contributor:</b> Joseph</p>
 <p><b>SQL:</b> </p>
 <p>
 <b>How it works:</b>
 
 
 </p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>topicId</code> - the topic to get.</dd>
<dd><code>page</code> - if 0, fetch all posts, if n > 0, fetch posts
 10*(n-1)+1 up to 10*n, where the first post is number 1.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The topic view if one exists with the given id and range,
 (i.e. for getTopic(tid, 3) there must be at least 31 posts)
 otherwise failure (or fatal on database errors).</dd>
</dl>
</li>
</ul>
<a name="likeTopic-java.lang.String-long-boolean-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>likeTopic</h4>
<pre>public&nbsp;Result&nbsp;likeTopic(java.lang.String&nbsp;username,
                        long&nbsp;topicId,
                        boolean&nbsp;like)</pre>
<div class="block"><p>Like or unlike a topic. A topic is either liked or not, when calling this
 twice in a row with the same parameters, the second call is a no-op (this
 function is idempotent).</p>
 <p><b>Visual Test:</b> </p>
 <p><b>Main Contributor:</b> Joseph</p>
 <p><b>SQL:</b> </p>
 <p>
 <b>How it works:</b>
 
 
 </p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>username</code> - the person liking the topic (must exist).</dd>
<dd><code>topicId</code> - the topic to like (must exist).</dd>
<dd><code>like</code> - true to like, false to unlike.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>success (even if it was a no-op), failure if the person or topic
 does not exist and fatal in case of db errors.</dd>
</dl>
</li>
</ul>
<a name="favouriteTopic-java.lang.String-long-boolean-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>favouriteTopic</h4>
<pre>public&nbsp;Result&nbsp;favouriteTopic(java.lang.String&nbsp;username,
                             long&nbsp;topicId,
                             boolean&nbsp;fav)</pre>
<div class="block"><p>Set or unset a topic as favourite. Same semantics as likeTopic.</p>
 <p><b>Visual Test:</b> </p>
 <p><b>Main Contributor:</b> </p>
 <p><b>SQL:</b> </p>
 <p>
 <b>How it works:</b>
 
 
 </p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>username</code> - the person setting the favourite topic (must exist).</dd>
<dd><code>topicId</code> - the topic to set as favourite (must exist).</dd>
<dd><code>fav</code> - true to set, false to unset as favourite.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>success (even if it was a no-op), failure if the person or topic
 does not exist and fatal in case of db errors.</dd>
</dl>
</li>
</ul>
<a name="createTopic-long-java.lang.String-java.lang.String-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createTopic</h4>
<pre>public&nbsp;Result&nbsp;createTopic(long&nbsp;forumId,
                          java.lang.String&nbsp;username,
                          java.lang.String&nbsp;title,
                          java.lang.String&nbsp;text)</pre>
<div class="block"><h1>DELETETOPIC NEEDS TO ROLLBACK</h1>
 <p>Create a new topic in a forum.</p>
 <p><b>Visual Test:</b> </p>
 <p><b>Main Contributor:</b> Tom</p>
 <p><b>SQL1:</b> INSERT INTO Topic (forumid, title) VALUES (?,?);</p>
 <p><b>SQL2:</b> INSERT INTO Post (authorid, topicid, text) VALUES ( 
 (SELECT id FROM Person WHERE username = ?),
 (SELECT id FROM Topic WHERE title = ?),
 ?);</p>
 <p>
 <b>How it works:</b>
 
 
 </p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>forumId</code> - the id of the forum in which to create the topic. This
 forum must exist.</dd>
<dd><code>username</code> - the username under which to make this post. Must refer
 to an existing username.</dd>
<dd><code>title</code> - the title of this topic. Cannot be empty.</dd>
<dd><code>text</code> - the text of the initial post. Cannot be empty.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>failure if any of the preconditions are not met (forum does not
 exist, user does not exist, title or text empty);
 success if the post was created and fatal if something else went wrong.</dd>
</dl>
</li>
</ul>
<a name="getAdvancedForums--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getAdvancedForums</h4>
<pre>public&nbsp;&lt;any&gt;&nbsp;getAdvancedForums()</pre>
<div class="block"><p>Get the "main page" containing a list of forums ordered alphabetically
 by title. Advanced version.</p>
 <p><b>Visual Test:</b> </p>
 <p><b>Main Contributor:</b> </p>
 <p><b>SQL:</b> </p>
 <p>
 <b>How it works:</b>
 
 
 </p></div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the list of all forums.</dd>
</dl>
</li>
</ul>
<a name="getAdvancedPersonView-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getAdvancedPersonView</h4>
<pre>public&nbsp;&lt;any&gt;&nbsp;getAdvancedPersonView(java.lang.String&nbsp;username)</pre>
<div class="block"><p>Get an AdvancedPersonView for the person with the given username.</p>
 <p><b>Visual Test:</b> </p>
 <p><b>Main Contributor:</b> </p>
 <p><b>SQL:</b> </p>
 <p>
 <b>How it works:</b>
 
 
 </p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>username</code> - the username to search for, cannot be empty.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>If a person with the given username exists, a fully populated
 AdvancedPersonView. Otherwise, failure (or fatal on a database error).</dd>
</dl>
</li>
</ul>
<a name="getAdvancedForum-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getAdvancedForum</h4>
<pre>public&nbsp;&lt;any&gt;&nbsp;getAdvancedForum(long&nbsp;id)</pre>
<div class="block"><p>Get the detailed view of a single forum, advanced version.</p>
 <p><b>Visual Test:</b> </p>
 <p><b>Main Contributor:</b> </p>
 <p><b>SQL:</b> </p>
 <p>
 <b>How it works:</b>
 
 
 </p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>id</code> - the id of the forum to get.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>A view of this forum if it exists, otherwise failure.</dd>
</dl>
</li>
</ul>
<a name="likePost-java.lang.String-long-int-boolean-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>likePost</h4>
<pre>public&nbsp;Result&nbsp;likePost(java.lang.String&nbsp;username,
                       long&nbsp;topicId,
                       int&nbsp;post,
                       boolean&nbsp;like)</pre>
<div class="block"><p>Like or unlike a post. Liking a post that you have already liked
 (or unliking a post you haven't liked) is a no-op, not an error.</p>
 <p><b>Visual Test:</b> </p>
 <p><b>Main Contributor:</b> Alex</p>
 <p><b>SQL:</b> </p>
 <p>
 <b>How it works:</b>
 
 
 </p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>username</code> - the person liking/unliking the post. Must exist.</dd>
<dd><code>topicId</code> - the topic with the post to (un)like. Must exist.</dd>
<dd><code>post</code> - the index of the post to (un)like. Must exist.</dd>
<dd><code>like</code> - true to like, false to unlike.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>failure if the person or post referenced to not exist,
 success if the (un)like succeeded, fatal in case of other errors.</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../uk/ac/bris/cs/databases/cwk3/package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Class</li>
<li>Next&nbsp;Class</li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?uk/ac/bris/cs/databases/cwk3/API.html" target="_top">Frames</a></li>
<li><a href="API.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
